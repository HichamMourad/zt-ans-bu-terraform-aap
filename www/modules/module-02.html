<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Infrastructure Data Gathering with Ansible :: Ansible Automation Roadshow - Scenario 01</title>
    <link rel="canonical" href="https://redhat-scholars.github.io/course-template/modules/module-02.html">
    <link rel="prev" href="module-01.html">
    <link rel="next" href="module-03.html">
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../_/css/site.css">
<link rel="icon" href="../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://demo.redhat.com" target="_blank" style="margin-left: 5%;">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1508.5 178.739" style="width: 278px;"><g fill="#fff"><path d="M316.6 63.2v-56H342a21.279 21.279 0 0 1 7.8 1.3 18.111 18.111 0 0 1 5.9 3.5 15.577 15.577 0 0 1 5 11.8 15.051 15.051 0 0 1-3.1 9.5 16.836 16.836 0 0 1-8.4 5.8l12.5 24.1h-9.3l-11.6-23H325v23Zm24.7-48.6H325v18.7h16.3q5.25 0 8.1-2.7a8.7 8.7 0 0 0 2.8-6.6 8.7 8.7 0 0 0-2.8-6.6c-1.8-1.9-4.5-2.8-8.1-2.8ZM364.1 42.8a20.674 20.674 0 0 1 1.6-8.2 20.288 20.288 0 0 1 4.3-6.7 19.92 19.92 0 0 1 6.5-4.5 19.718 19.718 0 0 1 8-1.6 18.463 18.463 0 0 1 7.8 1.6 18.677 18.677 0 0 1 6.2 4.5 20.927 20.927 0 0 1 4.1 6.8 23.2 23.2 0 0 1 1.5 8.4v2.3H372a13.822 13.822 0 0 0 4.6 8.4 13.6 13.6 0 0 0 9.1 3.3 15.553 15.553 0 0 0 5.7-1 12.858 12.858 0 0 0 4.6-2.6l5.1 5a25.983 25.983 0 0 1-7.4 4.1 24.69 24.69 0 0 1-8.4 1.3 21.306 21.306 0 0 1-8.4-1.6 22.763 22.763 0 0 1-6.8-4.4 20.788 20.788 0 0 1-4.5-6.7 23.2 23.2 0 0 1-1.5-8.4Zm20.2-14.2a11.527 11.527 0 0 0-8 3 13.046 13.046 0 0 0-4.2 7.8h24.2a13.091 13.091 0 0 0-4.2-7.8 11.106 11.106 0 0 0-7.8-3ZM443.1 63.2v-3.8a19.448 19.448 0 0 1-5.8 3.3 18.924 18.924 0 0 1-6.7 1.2 19.824 19.824 0 0 1-14.6-6.1 22.268 22.268 0 0 1-4.4-6.7 21.812 21.812 0 0 1 0-16.4A20.534 20.534 0 0 1 416 28a19.335 19.335 0 0 1 6.6-4.5 20.334 20.334 0 0 1 8.2-1.6 20.7 20.7 0 0 1 6.6 1 19.415 19.415 0 0 1 5.7 3V7.2l8-1.8v57.8Zm-25.2-20.4a13.718 13.718 0 0 0 4 10.1 13.45 13.45 0 0 0 9.8 4.1 14.956 14.956 0 0 0 6.4-1.3 15.954 15.954 0 0 0 4.9-3.6V33.6a14.988 14.988 0 0 0-4.9-3.5 15.271 15.271 0 0 0-6.4-1.3 13.423 13.423 0 0 0-9.9 4 13.806 13.806 0 0 0-3.9 10ZM478.1 63.2v-56h8.4v24h29.8v-24h8.4v56h-8.4V38.8h-29.8v24.4ZM547.2 64a16.483 16.483 0 0 1-10.8-3.5 11.037 11.037 0 0 1-4.2-8.9 10.375 10.375 0 0 1 4.7-9.2 20.76 20.76 0 0 1 11.8-3.2 27.841 27.841 0 0 1 5.8.6 27.374 27.374 0 0 1 5.3 1.6v-4.3a8.143 8.143 0 0 0-2.6-6.5 11.452 11.452 0 0 0-7.4-2.2 20.788 20.788 0 0 0-6 .9 34.616 34.616 0 0 0-6.6 2.6l-3-6a54.169 54.169 0 0 1 8.4-3.1 33.18 33.18 0 0 1 8.3-1.1c5.2 0 9.3 1.3 12.2 3.8s4.4 6.1 4.4 10.8v27h-7.8v-3.5a19.441 19.441 0 0 1-5.8 3.2 23.54 23.54 0 0 1-6.7 1Zm-7.3-12.6a5.646 5.646 0 0 0 2.6 4.8 11.193 11.193 0 0 0 6.6 1.8 16.256 16.256 0 0 0 5.9-1 14.449 14.449 0 0 0 4.9-2.9V47a19.778 19.778 0 0 0-4.8-1.8 24.933 24.933 0 0 0-5.7-.6 11.859 11.859 0 0 0-6.8 1.8 5.728 5.728 0 0 0-2.7 5ZM580.6 53.2v-24H572v-6.7h8.6V12.1l7.9-1.9v12.3h12v6.7h-12v22.1a5.94 5.94 0 0 0 1.4 4.4c.9.9 2.5 1.3 4.6 1.3a23.637 23.637 0 0 0 3-.2 10.857 10.857 0 0 0 2.8-.8v6.7a19.28 19.28 0 0 1-3.8.9 27.484 27.484 0 0 1-3.8.3c-3.9 0-7-.9-9-2.8-2-1.7-3.1-4.4-3.1-7.9Z"></path></g><path d="M127 90.2c12.5 0 30.6-2.6 30.6-17.5a12.678 12.678 0 0 0-.3-3.4L149.8 37c-1.7-7.1-3.2-10.3-15.7-16.6-9.7-5-30.8-13.1-37.1-13.1-5.8 0-7.5 7.5-14.4 7.5-6.7 0-11.6-5.6-17.9-5.6-6 0-9.9 4.1-12.9 12.5 0 0-8.4 23.7-9.5 27.2a4.216 4.216 0 0 0-.3 1.9c0 9.2 36.3 39.4 85 39.4Zm32.5-11.4c1.7 8.2 1.7 9.1 1.7 10.1 0 14-15.7 21.8-36.4 21.8-46.8 0-87.7-27.4-87.7-45.5a17.535 17.535 0 0 1 1.5-7.3C21.8 58.8 0 61.8 0 81c0 31.5 74.6 70.3 133.7 70.3 45.3 0 56.7-20.5 56.7-36.6-.1-12.8-11-27.3-30.9-35.9Z" fill="#e00"></path><path d="M159.5 78.8c1.7 8.2 1.7 9.1 1.7 10.1 0 14-15.7 21.8-36.4 21.8-46.8 0-87.7-27.4-87.7-45.5a17.535 17.535 0 0 1 1.5-7.3l3.7-9.1a4.877 4.877 0 0 0-.3 2c0 9.2 36.3 39.4 85 39.4 12.5 0 30.6-2.6 30.6-17.5a12.678 12.678 0 0 0-.3-3.4Z"></path><path d="M253.5 158.7a2.22 2.22 0 0 1-2.2-2.2V2.2a2.2 2.2 0 0 1 4.4 0v154.2a2.242 2.242 0 0 1-2.2 2.3Z" fill="#fff"></path><text data-name="Demo Platform" transform="translate(1186 149)" fill="#fff" font-size="82" font-family="'RedHatDisplay', 'Overpass', overpass, helvetica, arial, sans-serif" font-weight="700"><tspan x="-877.892" y="0">Demo Platform</tspan></text></svg>
      </a>
      <a class="navbar-item site-title" target="__blank" style="color: #fff !important;" href="https://redhat-scholars.github.io/course-template">Ansible Automation Roadshow - Scenario 01</a>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item navbar-item-right-dropdown has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Links</a>
          <div class="navbar-dropdown navbar-dropdown-right">
            <a class="navbar-item navbar-item-right-content" href="https://redhat.com" target="_blank">Red Hat</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="modules" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html" class=" query-params-link">Exercises</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="module-01.html">1. Automated Backups</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="module-01.html#backupLinux">Backing up Linux</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="module-01.html#backupWindows">Windows VSS</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="module-01.html#codeSnippets">Code Snippets</a>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="module-02.html">2. Infrastructure Awareness</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#atscale">System Reports</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#compliance">Compliance Reporting</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#codeSnippets">Code Snippets</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="module-03.html">3. Windows Reports</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="module-03.html#lastCheck">Check Schedule</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="module-03.html#codeSnippets">Code Snippets</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Exercises</span>
      <ul class="versions">
        <li class="version is-current">
          <a href="index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Exercises</a></li>
    <li><a href="module-02.html">2. Infrastructure Awareness</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">Infrastructure Data Gathering with Ansible</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">Introduction</a>
<ul class="sectlevel2">
<li><a href="#_lab_environment_setup">Lab Environment Setup</a></li>
</ul>
</li>
<li><a href="#_lab_exercises">Lab Exercises</a>
<ul class="sectlevel2">
<li><a href="#_exercise_1_gathering_server_information">Exercise 1: Gathering Server Information</a></li>
<li><a href="#_exercise_2_generating_infrastructure_reports_at_scale">Exercise 2: Generating Infrastructure Reports at Scale</a></li>
<li><a href="#_exercise_3_compliance_reporting_with_openscap">Exercise 3: Compliance Reporting with OpenSCAP</a></li>
</ul>
</li>
<li><a href="#_code_reference">Code Reference</a>
<ul class="sectlevel2">
<li><a href="#_openscap_automation_implementation">OpenSCAP Automation Implementation</a></li>
</ul>
</li>
<li><a href="#_key_takeaways">Key Takeaways</a></li>
<li><a href="#_next_steps">Next Steps</a></li>
</ul>
</div>
<div class="sect1">
<h2 id="_introduction"><a class="anchor" href="#_introduction"></a>Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Gathering comprehensive data about your infrastructure is one of the best starting points for automation with Ansible. While you know you have servers and networks, auditing and collecting all system data can be a massive undertaking. Fortunately, Ansible excels at this task and can scale to handle infrastructure of any size.</p>
</div>
<div class="paragraph">
<p>This lab will guide you through using Ansible to collect system information, generate reports, and perform compliance audits across your infrastructure.</p>
</div>
<div class="sect2">
<h3 id="_lab_environment_setup"><a class="anchor" href="#_lab_environment_setup"></a>Lab Environment Setup</h3>
<div class="sect3">
<h4 id="_access_credentials"><a class="anchor" href="#_access_credentials"></a>Access Credentials</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Username</th>
<th class="tableblock halign-left valign-top">Password</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">admin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ansible123!</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_exercises"><a class="anchor" href="#_lab_exercises"></a>Lab Exercises</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_exercise_1_gathering_server_information"><a class="anchor" href="#_exercise_1_gathering_server_information"></a>Exercise 1: Gathering Server Information</h3>
<div class="paragraph">
<p>Let&#8217;s start by collecting detailed system facts from individual servers using Ansible&#8217;s built-in capabilities.</p>
</div>
<div class="sect3">
<h4 id="_step_1_access_the_inventory"><a class="anchor" href="#_step_1_access_the_inventory"></a>Step 1: Access the Inventory</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Navigate to your lab <code>aap</code> tab and login using the credentials above</p>
</li>
<li>
<p>Navigate to <strong>Automation Execution</strong> → <strong>Infrastructure</strong> → <strong>Inventories</strong></p>
</li>
<li>
<p>Select the <strong>Video Platform Inventory</strong></p>
</li>
<li>
<p>Click on the <strong>Hosts</strong> tab</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This inventory contains the systems we&#8217;ll be automating. You should see several hosts already configured for you.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/node01-setup.png" alt="Node Setup Interface">
</div>
<div class="title">Figure 1. Node Setup View</div>
</div>
</div>
<div class="sect3">
<h4 id="_step_2_run_ad_hoc_commands"><a class="anchor" href="#_step_2_run_ad_hoc_commands"></a>Step 2: Run Ad-hoc Commands</h4>
<div class="paragraph">
<p>We&#8217;ll use Ansible Automation Platform&#8217;s ad-hoc command feature to gather system facts:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Select the host <code>node01</code></p>
</li>
<li>
<p>Click on <strong>Run command</strong></p>
</li>
<li>
<p>From the module dropdown list, select the <strong>Setup</strong> module</p>
</li>
<li>
<p>Click <strong>Next</strong></p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/setup.png" alt="Setup Module Interface">
</div>
<div class="title">Figure 2. Setup Module Selection</div>
</div>
</div>
<div class="sect3">
<h4 id="_step_3_configure_execution_environment"><a class="anchor" href="#_step_3_configure_execution_environment"></a>Step 3: Configure Execution Environment</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Select the <strong>Default execution environment</strong> from the dropdown</p>
</li>
<li>
<p>Click <strong>Next</strong></p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_step_4_choose_credentials"><a class="anchor" href="#_step_4_choose_credentials"></a>Step 4: Choose Credentials</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Select the <strong>Application Nodes</strong> credential</p>
</li>
<li>
<p>Click <strong>Next</strong></p>
</li>
<li>
<p>Click <strong>Finish</strong> to execute the command</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_step_5_review_system_facts"><a class="anchor" href="#_step_5_review_system_facts"></a>Step 5: Review System Facts</h4>
<div class="paragraph">
<p>Once the command executes, you&#8217;ll see comprehensive system facts displayed. This includes all the information Ansible can automatically gather from the target system.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/setup-output.png" alt="Setup Output Results">
</div>
<div class="title">Figure 3. System Facts Output</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The Setup module collects extensive system information including hardware details, network configuration, installed packages, and operating system specifics. This data forms the foundation for infrastructure automation and reporting.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exercise_2_generating_infrastructure_reports_at_scale"><a class="anchor" href="#_exercise_2_generating_infrastructure_reports_at_scale"></a>Exercise 2: Generating Infrastructure Reports at Scale</h3>
<div class="paragraph">
<p>Now let&#8217;s leverage Ansible&#8217;s templating capabilities to create dynamic reports based on collected facts and task results.</p>
</div>
<div class="sect3">
<h4 id="_understanding_infrastructure_awareness"><a class="anchor" href="#_understanding_infrastructure_awareness"></a>Understanding Infrastructure Awareness</h4>
<div class="paragraph">
<p>Infrastructure awareness is crucial for effective IT operations. Ansible makes this easy by combining fact collection with Jinja templating to generate comprehensive, dynamic reports.</p>
</div>
</div>
<div class="sect3">
<h4 id="_step_1_generate_application_server_report"><a class="anchor" href="#_step_1_generate_application_server_report"></a>Step 1: Generate Application Server Report</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Navigate to <strong>Automation Execution</strong> → <strong>Templates</strong></p>
</li>
<li>
<p>Execute the <strong>Application Server Report</strong> template</p>
</li>
<li>
<p>When prompted with options, click <strong>All</strong></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This template will collect information from all your application servers and generate a comprehensive report.</p>
</div>
</div>
<div class="sect3">
<h4 id="_step_2_view_the_generated_report"><a class="anchor" href="#_step_2_view_the_generated_report"></a>Step 2: View the Generated Report</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Once the template execution completes, navigate to the <strong>Report Server</strong> tab</p>
</li>
<li>
<p>Refresh the page to see the newly generated report</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/srv-report.png" alt="Server Report Dashboard">
</div>
<div class="title">Figure 4. Server Report Overview</div>
</div>
<div class="paragraph">
<p>Notice that the report includes backup information alongside system details, providing a holistic view of your infrastructure status.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/backup-data.png" alt="Backup Report Section">
</div>
<div class="title">Figure 5. Backup Data Integration</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can re-run the report template and select different options to create targeted reports for specific criteria or server subsets.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exercise_3_compliance_reporting_with_openscap"><a class="anchor" href="#_exercise_3_compliance_reporting_with_openscap"></a>Exercise 3: Compliance Reporting with OpenSCAP</h3>
<div class="paragraph">
<p>Security compliance is a critical requirement for most organizations. Let&#8217;s generate a compliance report using OpenSCAP integration.</p>
</div>
<div class="sect3">
<h4 id="_background_why_compliance_reports_matter"><a class="anchor" href="#_background_why_compliance_reports_matter"></a>Background: Why Compliance Reports Matter</h4>
<div class="paragraph">
<p>Information Security teams require regular compliance reports to ensure systems meet organizational and regulatory requirements. Ansible can automate OpenSCAP scans to provide these reports consistently and at scale.</p>
</div>
</div>
<div class="sect3">
<h4 id="_step_1_generate_compliance_report"><a class="anchor" href="#_step_1_generate_compliance_report"></a>Step 1: Generate Compliance Report</h4>
<div class="paragraph">
<p>Security has specifically requested a compliance report for <code>Node02</code>. Let&#8217;s fulfill this request:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Navigate to <strong>Automation Execution</strong> → <strong>Templates</strong></p>
</li>
<li>
<p>Execute the <strong>OpenSCAP Report</strong> template</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_step_2_access_compliance_results"><a class="anchor" href="#_step_2_access_compliance_results"></a>Step 2: Access Compliance Results</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Once the job completes, navigate to the <strong>Compliance Report</strong> tab</p>
</li>
<li>
<p>You&#8217;ll see the generated compliance report files</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/compliance_report_folder.png" alt="Compliance Report Folder">
</div>
<div class="title">Figure 6. Compliance Report Directory</div>
</div>
</div>
<div class="sect3">
<h4 id="_step_3_review_detailed_results"><a class="anchor" href="#_step_3_review_detailed_results"></a>Step 3: Review Detailed Results</h4>
<div class="paragraph">
<p>Click on the report file to view the detailed compliance results, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Security control assessments</p>
</li>
<li>
<p>Pass/fail status for each check</p>
</li>
<li>
<p>Remediation recommendations</p>
</li>
<li>
<p>Risk severity levels</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/compliance_report.png" alt="Compliance Report Details">
</div>
<div class="title">Figure 7. Detailed Compliance Report</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_reference"><a class="anchor" href="#_code_reference"></a>Code Reference</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_openscap_automation_implementation"><a class="anchor" href="#_openscap_automation_implementation"></a>OpenSCAP Automation Implementation</h3>
<div class="paragraph">
<p>Here&#8217;s the key Ansible code used for automated compliance reporting:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">tasks:
  - name: Check if the system is RHEL 8
    ansible.builtin.debug:
      msg: "This playbook is not compatible with {{ inventory_hostname }} (not RHEL 8)"
    when: ansible_distribution != "RedHat" or ansible_distribution_major_version != "8"
    failed_when: false

  - name: Run compliance tasks on RHEL 8 systems only
    when: ansible_distribution == "RedHat" and ansible_distribution_major_version == "8"
    block:
      - name: Get our facts straight
        ansible.builtin.set_fact:
          _profile: '{{ compliance_profile | replace("pci_dss", "pci-dss") }}'
          _report_dir: /tmp/oscap-reports

      - name: Ensure OpenSCAP tools are installed
        ansible.builtin.dnf:
          name: '{{ openscap_packages }}'
          state: present

      - name: Configure httpd
        when: use_httpd | bool
        block:
          - name: Install httpd
            ansible.builtin.dnf:
              name: httpd
              state: present
            notify: Restart httpd

          - name: Override report directory
            ansible.builtin.set_fact:
              _report_dir: /var/www/html/oscap-reports

          - name: Gather service facts
            ansible.builtin.service_facts:

          - name: Enable firewall http service
            ansible.posix.firewalld:
              service: http
              state: enabled
              immediate: true
              permanent: true
            when: "'firewalld.service' in ansible_facts.services"

          - name: Disable httpd welcome page
            ansible.builtin.file:
              path: /etc/httpd/conf.d/welcome.conf
              state: absent
            notify: Restart httpd

      - name: Create report on Report Server
        block:
          - name: Ensure report directory exists
            ansible.builtin.file:
              path: '{{ _report_dir }}/{{ _profile }}'
              state: directory
              owner: root
              group: root
              mode: 0755

          - name: Set report name
            ansible.builtin.set_fact:
              _report: '{{ _report_dir }}/{{ _profile }}/report-{{ inventory_hostname }}-{{ ansible_date_time.iso8601 }}.html'

          - name: Generate compliance report
            ansible.builtin.command: &gt;-
              oscap xccdf eval --profile {{ _profile }} --report {{ _report }}
              /usr/share/xml/scap/ssg/content/ssg-rhel{{ ansible_distribution_major_version }}-ds.xml
            args:
              creates: '{{ _report }}'
            register: _oscap
            failed_when: _oscap.rc not in [0, 2]

          - name: Set report permissions
            ansible.builtin.file:
              path: '{{ _report }}'
              owner: root
              group: root
              mode: 0644</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_key_takeaways"><a class="anchor" href="#_key_takeaways"></a>Key Takeaways</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You&#8217;ve successfully completed the infrastructure data gathering exercises! You now understand how to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>✅ <strong>Collect System Facts</strong>: Use Ansible&#8217;s Setup module to gather comprehensive system information</p>
</li>
<li>
<p>✅ <strong>Generate Dynamic Reports</strong>: Leverage Jinja templating to create infrastructure reports at scale</p>
</li>
<li>
<p>✅ <strong>Automate Compliance Audits</strong>: Implement OpenSCAP integration for security compliance reporting</p>
</li>
<li>
<p>✅ <strong>Scale Data Collection</strong>: Apply these techniques across multiple systems simultaneously</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_next_steps"><a class="anchor" href="#_next_steps"></a>Next Steps</h2>
<div class="sectionbody">
<div class="paragraph">
<p>With these foundational skills in infrastructure data gathering, you&#8217;re ready to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Implement regular automated reporting schedules</p>
</li>
<li>
<p>Expand compliance scanning to additional security frameworks</p>
</li>
<li>
<p>Create custom reports tailored to your organization&#8217;s specific needs</p>
</li>
<li>
<p>Build more complex automation workflows using the collected system data</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This infrastructure awareness foundation will serve as the basis for more advanced automation scenarios throughout your Ansible journey.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="module-01.html" class="query-params-link">1. Automated Backups</a></span>
  <span class="next"><a href="module-03.html" class="query-params-link">3. Windows Reports</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>  </div>
</main>
</div>
<footer class="footer">
  <a href="https://demo.redhat.com" target="_blank" class="poweredBy"><p>Powered by</p><div class="labInfo_poweredBy" style="display: block; width: 260px;"><svg class="labInfo_poweredByLogo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1508.5 178.739"><g fill="#111"><path d="M316.6 63.2v-56H342a21.279 21.279 0 0 1 7.8 1.3 18.111 18.111 0 0 1 5.9 3.5 15.577 15.577 0 0 1 5 11.8 15.051 15.051 0 0 1-3.1 9.5 16.836 16.836 0 0 1-8.4 5.8l12.5 24.1h-9.3l-11.6-23H325v23Zm24.7-48.6H325v18.7h16.3q5.25 0 8.1-2.7a8.7 8.7 0 0 0 2.8-6.6 8.7 8.7 0 0 0-2.8-6.6c-1.8-1.9-4.5-2.8-8.1-2.8ZM364.1 42.8a20.674 20.674 0 0 1 1.6-8.2 20.288 20.288 0 0 1 4.3-6.7 19.92 19.92 0 0 1 6.5-4.5 19.718 19.718 0 0 1 8-1.6 18.463 18.463 0 0 1 7.8 1.6 18.677 18.677 0 0 1 6.2 4.5 20.927 20.927 0 0 1 4.1 6.8 23.2 23.2 0 0 1 1.5 8.4v2.3H372a13.822 13.822 0 0 0 4.6 8.4 13.6 13.6 0 0 0 9.1 3.3 15.553 15.553 0 0 0 5.7-1 12.858 12.858 0 0 0 4.6-2.6l5.1 5a25.983 25.983 0 0 1-7.4 4.1 24.69 24.69 0 0 1-8.4 1.3 21.306 21.306 0 0 1-8.4-1.6 22.763 22.763 0 0 1-6.8-4.4 20.788 20.788 0 0 1-4.5-6.7 23.2 23.2 0 0 1-1.5-8.4Zm20.2-14.2a11.527 11.527 0 0 0-8 3 13.046 13.046 0 0 0-4.2 7.8h24.2a13.091 13.091 0 0 0-4.2-7.8 11.106 11.106 0 0 0-7.8-3ZM443.1 63.2v-3.8a19.448 19.448 0 0 1-5.8 3.3 18.924 18.924 0 0 1-6.7 1.2 19.824 19.824 0 0 1-14.6-6.1 22.268 22.268 0 0 1-4.4-6.7 21.812 21.812 0 0 1 0-16.4A20.534 20.534 0 0 1 416 28a19.335 19.335 0 0 1 6.6-4.5 20.334 20.334 0 0 1 8.2-1.6 20.7 20.7 0 0 1 6.6 1 19.415 19.415 0 0 1 5.7 3V7.2l8-1.8v57.8Zm-25.2-20.4a13.718 13.718 0 0 0 4 10.1 13.45 13.45 0 0 0 9.8 4.1 14.956 14.956 0 0 0 6.4-1.3 15.954 15.954 0 0 0 4.9-3.6V33.6a14.988 14.988 0 0 0-4.9-3.5 15.271 15.271 0 0 0-6.4-1.3 13.423 13.423 0 0 0-9.9 4 13.806 13.806 0 0 0-3.9 10ZM478.1 63.2v-56h8.4v24h29.8v-24h8.4v56h-8.4V38.8h-29.8v24.4ZM547.2 64a16.483 16.483 0 0 1-10.8-3.5 11.037 11.037 0 0 1-4.2-8.9 10.375 10.375 0 0 1 4.7-9.2 20.76 20.76 0 0 1 11.8-3.2 27.841 27.841 0 0 1 5.8.6 27.374 27.374 0 0 1 5.3 1.6v-4.3a8.143 8.143 0 0 0-2.6-6.5 11.452 11.452 0 0 0-7.4-2.2 20.788 20.788 0 0 0-6 .9 34.616 34.616 0 0 0-6.6 2.6l-3-6a54.169 54.169 0 0 1 8.4-3.1 33.18 33.18 0 0 1 8.3-1.1c5.2 0 9.3 1.3 12.2 3.8s4.4 6.1 4.4 10.8v27h-7.8v-3.5a19.441 19.441 0 0 1-5.8 3.2 23.54 23.54 0 0 1-6.7 1Zm-7.3-12.6a5.646 5.646 0 0 0 2.6 4.8 11.193 11.193 0 0 0 6.6 1.8 16.256 16.256 0 0 0 5.9-1 14.449 14.449 0 0 0 4.9-2.9V47a19.778 19.778 0 0 0-4.8-1.8 24.933 24.933 0 0 0-5.7-.6 11.859 11.859 0 0 0-6.8 1.8 5.728 5.728 0 0 0-2.7 5ZM580.6 53.2v-24H572v-6.7h8.6V12.1l7.9-1.9v12.3h12v6.7h-12v22.1a5.94 5.94 0 0 0 1.4 4.4c.9.9 2.5 1.3 4.6 1.3a23.637 23.637 0 0 0 3-.2 10.857 10.857 0 0 0 2.8-.8v6.7a19.28 19.28 0 0 1-3.8.9 27.484 27.484 0 0 1-3.8.3c-3.9 0-7-.9-9-2.8-2-1.7-3.1-4.4-3.1-7.9Z"></path></g><path d="M127 90.2c12.5 0 30.6-2.6 30.6-17.5a12.678 12.678 0 0 0-.3-3.4L149.8 37c-1.7-7.1-3.2-10.3-15.7-16.6-9.7-5-30.8-13.1-37.1-13.1-5.8 0-7.5 7.5-14.4 7.5-6.7 0-11.6-5.6-17.9-5.6-6 0-9.9 4.1-12.9 12.5 0 0-8.4 23.7-9.5 27.2a4.216 4.216 0 0 0-.3 1.9c0 9.2 36.3 39.4 85 39.4Zm32.5-11.4c1.7 8.2 1.7 9.1 1.7 10.1 0 14-15.7 21.8-36.4 21.8-46.8 0-87.7-27.4-87.7-45.5a17.535 17.535 0 0 1 1.5-7.3C21.8 58.8 0 61.8 0 81c0 31.5 74.6 70.3 133.7 70.3 45.3 0 56.7-20.5 56.7-36.6-.1-12.8-11-27.3-30.9-35.9Z" fill="#e00"></path><path d="M159.5 78.8c1.7 8.2 1.7 9.1 1.7 10.1 0 14-15.7 21.8-36.4 21.8-46.8 0-87.7-27.4-87.7-45.5a17.535 17.535 0 0 1 1.5-7.3l3.7-9.1a4.877 4.877 0 0 0-.3 2c0 9.2 36.3 39.4 85 39.4 12.5 0 30.6-2.6 30.6-17.5a12.678 12.678 0 0 0-.3-3.4Z"></path><path d="M253.5 158.7a2.22 2.22 0 0 1-2.2-2.2V2.2a2.2 2.2 0 0 1 4.4 0v154.2a2.242 2.242 0 0 1-2.2 2.3Z" fill="#111"></path><text data-name="Demo Platform" transform="translate(1186 149)" fill="#111" font-size="82" font-family="'RedHatDisplay', 'Overpass', overpass, helvetica, arial, sans-serif" font-weight="700"><tspan x="-877.892" y="0">Demo Platform</tspan></text></svg></div></div>
</footer>
<script src="../_/js/vendor/clipboard.js"></script>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
